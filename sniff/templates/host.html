{% extends 'navigationbar.html' %}

{% load staticfiles %}

{% block title %}
	<title>Statistic</title>
{% endblock %}

{% block customcss %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/host.css' %}">
{% endblock %}

{% block custombody %}
	<div id="pageHeading">
			<p>Statistic by {{ host }} </p>
	</div>

	<div class="host">
		<table>
			<tr>
				<td><b>Host IP:</b>    {{ host }}</td>
				<td><b>Count DGA requests relatively all requests:</b> {{ count_dga_requests.count }}/{{ count_requests.count }}</td>
			</tr>
		</table>
		<div class="requests">
			<table>
				<tr>
					<th>IP destination</th>
					<th>Domain name</th>
					<th>Report date</th>
					<th>Is DGA?</th>
					<th>DGA Family</th>
				</tr>
				{% for request in requests %}
					<tr>
						<td>{{ request.ip_dst }}</td>
						<td>{{ request.qname }}</td>
						<td>{{ request.report_date }}</td>
						<td>{{ request.dga }}</td>
						<td>{{ request.dga_subtype }}</td>
					</tr>
				{% endfor %}
			</table>
		</div>
	</div>
{% endblock %}

{% block customjs %}
	<script type="text/javascript" src="{% static 'js/host.js' %}"></script>
{% endblock %}