{% extends 'navigationbar.html' %}

{% load staticfiles %}

{% block title %}
	<title>Statistic</title>
{% endblock %}

{% block customcss %}
	<link rel="stylesheet" type="text/css" href="{% static 'css/host.css' %}">
{% endblock %}

{% block custombody %}
	<div id="pageHeading">
			<p>Statistic by {{ host_details.ip }} </p>
	</div>

	<div class="host">
		<table>
			<tr>
				<td><b>Host IP:</b>    {{ host_details.ip }}</td>
				<td><b>Requests count:</b>    {{ host_details.requests_count }}</td>
				{% if host_details.is_blocked %}
					<td>
						<form action="/sniff/unblock_host/" id="unblockHostForm" method="post" >
							{% csrf_token %}
							<button type="submit" name="submit" class="unblockButton">Unblock</button>
						</form>
					</td>
				{% else %}
					<td style="text-align: right">
						<form action="/sniff/block_host/" id="blockHostForm" method="post" >
							{% csrf_token %}
							<button type="submit" name="submit" class="blockButton">Block</button>
						</form>
					</td>
				{% endif %}
			</tr>
		</table>
		<div class="requests">
			<table>
				<tr>
					<th>IP source</th>
					<th>IP destination</th>
					<th>Domain name</th>
					<th>Date</th>
				</tr>
				{% for request in requests %}
					<tr>
						<td>{{ request.ip_src }}</td>
						<td>{{ request.ip_dst }}</td>
						<td>{{ request.qname }}</td>
						<td>{{ request.date }}</td>
					</tr>
				{% endfor %}
			</table>
		</div>
	</div>
{% endblock %}

{% block customjs %}
	<script type="text/javascript" src="{% static 'js/host.js' %}"></script>
{% endblock %}